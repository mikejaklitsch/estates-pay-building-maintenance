# Auto-generated by tools/generate_building_hooks.py
# REPLACE blocks for buildings with existing on_built/on_destroyed hooks
# bey_fortress uses bey_fortress_maintenance (REPLACE due to existing on_built)

REPLACE:bey_fortress = {
	is_special = yes
	is_foreign = no
	pop_type = soldiers
	max_levels = 1
	employment_size = manpower_employment
	category = defense_category
	city = yes
	build_time = small_fort_building

	country_potential = {
		always = no
	}

	allow = {
		always = no
	}

	expensive = yes

	unique_production_methods = {
		epbm_bey_fortress_maintenance = {
			stone = 0.1
			tools = 0.1
			weaponry = 0.2
			tar = 0.1
			category = building_maintenance
		}
	}

	construction_demand = castle_construction

	modifier = {
		local_crown_estate_power = 0.25
		local_manpower = 0.01
		local_defensive = 0.25
		can_recruit_regiment_in_this_location = yes
	}

	on_built = {
		if = {
			limit = {
				location = location:izmit

				location.owner = {
					NOT = {
						has_variable = izmit_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.200
				set_variable = izmit_variable
			}
		}
		else_if = {
			limit = {
				location = location:bursa

				location.owner = {
					NOT = {
						has_variable = bursa_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.201
				set_variable = bursa_variable
			}
		}
		else_if = {
			limit = {
				location = location:konya

				location.owner = {
					NOT = {
						has_variable = konya_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.202
				set_variable = konya_variable
			}
		}
		else_if = {
			limit = {
				location = location:ankara

				location.owner = {
					NOT = {
						has_variable = ankara_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.203
				set_variable = ankara_variable
			}
		}
		else_if = {
			limit = {
				location = location:kayseri

				location.owner = {
					NOT = {
						has_variable = kayseri_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.204
				set_variable = kayseri_variable
			}
		}
		else_if = {
			limit = {
				location = location:sivas

				location.owner = {
					NOT = {
						has_variable = sivas_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.205
				set_variable = sivas_variable
			}
		}
		else_if = {
			limit = {
				location = location:smyrna

				location.owner = {
					NOT = {
						has_variable = smyrna_variable
					}
				}
			}

			location.owner = {
				trigger_event_non_silently = rise_of_the_ottomans.206
				set_variable = smyrna_variable
			}
		}
		else = { location = { trigger_event_non_silently = rise_of_the_ottomans.207 } }
		# EPBM: Track building for maintenance
		location = {
			add_to_variable_list = { name = epbm_building_types target = prev }
		}

		epbm_on_building_built = yes
	}

	on_destroyed = {
		# EPBM: Untrack building
		location = {
			remove_list_variable = { name = epbm_building_types target = prev }
		}

		epbm_on_building_destroyed = yes
	}
}

# monastery uses monastery_maintenance (REPLACE due to existing on_built)

REPLACE:monastery = {
	is_foreign = no
	max_levels = 1
	pop_type = clergy
	employment_size = large_religious_building_employment
	category = religious_category
	rural_settlement = yes
	town = yes
	city = yes
	build_time = religious_building_time

	graphical_tags = {
		medium_religious
	}

	country_potential = {
		modifier:can_have_monasteries = yes
	}

	possible_production_methods = {
		monastery_maintenance
		hab_reformed_monastery_maintenance
		composite_nature_maintenance
		single_nature_maintenance
		dual_nature_maintenance
		separate_nature_maintenance
	}

	on_built = {
		if = {
			limit = {
				location.owner = {
					religion = { has_sects = yes }
					is_member_of_international_organization_of_type = { type = sect }
				}
			}

			location.owner = {
				random_international_organizations_member_of = {
					limit = {
						international_organization_type = international_organization_type:sect
						NOT = {
							any_international_organization_enemy = { this = root.owner }
						}
						NOT = {
							has_location = root.location
						}
					}

					add_location_to_international_organization = root.location
				}
			}
		}

		# EPBM: Track building for maintenance
		location = {
			add_to_variable_list = { name = epbm_building_types target = prev }
		}

		epbm_on_building_built = yes
	}

	construction_demand = town_building_construction

	modifier = {
		local_clergy_food_consumption = 0.1
		local_clergy_max_literacy = 10
		local_pop_conversion_speed_modifier = 0.1
	}

	on_destroyed = {
		# EPBM: Untrack building
		location = {
			remove_list_variable = { name = epbm_building_types target = prev }
		}

		epbm_on_building_destroyed = yes
	}
}
